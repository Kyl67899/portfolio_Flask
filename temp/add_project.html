<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
    <title>Add/Edit Projects</title>
</head>

<body>
    <header>
        <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
            <div class="container-fluid">
                <a class="navbar-brand" href="{{ url_for('index') }}">My Portfolio</a>
                <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                    <span class="navbar-toggler-icon"></span>
                </button>

                <div class="collapse navbar-collapse" id="navbarNav">
                    <ul class="navbar-nav ms-auto">
                        <li class="nav-item">
                            <a class="nav-link" href="{{ url_for('index') }}">Home</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="{{ url_for('project') }}">Projects</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="{{ url_for('add_project') }}">Add Project</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="{{ url_for('contact') }}">Contact</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="" target="_blank">
                                Resume
                            </a>
                        </li>
                    </ul>
                </div>
            </div>
        </nav>
    </header>

    <main class="container flex-grow-1 mt-5">
        <div class="container mt-5">
            <h2>{{ 'Edit Project' if project else 'Add Project' }}</h2>

            {% with messages = get_flashed_messages(with_categories=true) %}
            {% if messages %}
            {% for category, message in messages %}
            <div class="alert alert-{{ category }} alert-dismissible fade show" role="alert">
                {{ message }}
                <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
            </div>
            {% endfor %}
            {% endif %}
            {% endwith %}

            <form method="POST">
                <!-- Title -->
                <label for="title" class="form-label">Title</label>
                <input type="text" name="title" value="{{ project.title if project else '' }}" class="form-control mb-2"
                    required>

                <!-- Category: Select or enter -->
                <label for="category" class="form-label">Category</label>

                <select name="category" class="form-select mb-2">
                    {% for option in ['Web Development', 'Data Science', 'Mobile App', 'Machine Learning', 'Other'] %}
                    <option value="{{ option }}" {% if project and project.category==option %}selected{% endif %}>{{
                        option }}</option>
                    {% endfor %}
                </select>
                <label for="category_custom" class="form-label">Custom Category</label>
                <textarea type="text" name="category_custom"
                    value="{% if project and project.category not in ['Web Development', 'Data Science', 'Mobile App', 'Machine Learning', 'Other'] %}{{ project.category }}{% endif %}"
                    placeholder="Or enter a custom category" class="form-control mb-2"></textarea>

                <!-- Objective -->
                <label for="objective" class="form-label">objective</label>
                <input type="text" name="objective" value="{{ project.objective if project else '' }}"
                    class="form-control mb-2" required>

                <!-- Summary -->
                <label for="summary" class="form-label">Summary</label>
                <input type="text" name="summary" value="{{ project.summary if project else '' }}"
                    class="form-control mb-2" required>

                <!-- Tools -->
                <label for="tools" class="form-label">Tools</label>
                <input type="text" name="tools" value="{{ (project.tools or []) | join(', ') if project else '' }}"
                    class="form-control mb-2" required>

                <!-- description -->
                <label for="description" class="form-label">Description</label>
                <input type="text" name="description" value="{{ (project.description or []) if project else '' }}"
                    class="form-control mb-2" required>

                <!-- Submit -->
                <button type="submit" class="btn btn-success">{{ 'Update' if project else 'Add' }}</button>
            </form>

            {% if project %}
            <form method="POST" action="{{ url_for('delete_project', id=project.id) }}"
                onsubmit="return confirm('Are you sure?');">
                <button type="submit" class="btn btn-danger mt-2">Delete</button>
            </form>
            {% endif %}
        </div>
    </main>

    <!-- Footer -->
    <footer class="bg-dark text-white text-center py-3 mt-5">
        &copy; 2025 Kyle Parsotan | <a href="{{ url_for('contact') }}" class="text-white">Contact</a> | <a
            href="/dashboard">Admin</a>
    </footer>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        setTimeout(() => {
            document.querySelectorAll(".alert").forEach(alert => {
                alert.classList.remove('show');
                alert.classList.add('fade');
            })
        }, 5000)
    </script>

</body>

</html>